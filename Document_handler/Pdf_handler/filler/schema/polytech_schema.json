{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Document Polytech",
  "type": "object",
  "properties": {
    "document_type": {
      "type": "string",
      "enum": ["cours", "projet", "administratif", "specialite", "vie_etudiante", "infrastructure"]
    },
    "metadata": {
      "type": "object",
      "properties": {
        "title": { "type": "string" },
        "date": { "type": "string", "format": "date" },
        "secteur": { "type": "string" },
        "auteurs": {
          "type": "array",
          "items": { "type": "string" }
        },
        "encadrant": { "type": "string" },
        "niveau": { "type": "string" },
        "annee": { "type": "string" },
        "specialite": { "type": "string" }
      },
      "required": ["title"]
    },
    "source": {
      "type": "object",
      "properties": {
        "category": {
          "type": "string",
          "enum": ["pdf_ajouté_manuellement", "scrapping"]
        },
        "chemin_local": { "type": "string" },
        "url": { "type": "string" },
        "site": { "type": "string" }
      },
      "required": ["chemin_local"]
    },
    "content": { "type": "string" },
    "tags": {
      "type": "array",
      "items": { "type": "string" }
    },
    "type_specific": {
      "type": "object",
      "description": "Champs spécifiques selon le type de document",
      "oneOf": [
        {
          "properties": {
            "cours": {
              "type": "object",
              "properties": {
                "logiciels": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "thematique": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "resume": { "type": "string" }
              }
            }
          },
          "required": ["cours"]
        },
        {
          "properties": {
            "projet": {
              "type": "object",
              "properties": {
                "client": { "type": "string" },
                "livrables": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "techno": {
                  "type": "array",
                  "items": { "type": "string" }
                }
              }
            }
          },
          "required": ["projet"]
        },
        {
          "properties": {
            "administratif": {
              "type": "object",
              "properties": {
                "service": { "type": "string" },
                "contact": {
                  "type": "object",
                  "properties": {
                    "email": { "type": "string", "format": "email" },
                    "telephone": { "type": "string" }
                  }
                }
              }
            }
          },
          "required": ["administratif"]
        },
        {
          "properties": {
            "specialite": {
              "type": "object",
              "properties": {
                "departement": { "type": "string" },
                "responsable": { "type": "string" }
              }
            }
          },
          "required": ["specialite"]
        },
        {
          "properties": {
            "vie_etudiante": {
              "type": "object",
              "properties": {
                "associations": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "evenements": {
                  "type": "array",
                  "items": { "type": "string" }
                }
              }
            }
          },
          "required": ["vie_etudiante"]
        },
        {
          "properties": {
            "infrastructure": {
              "type": "object",
              "properties": {
                "adresse": { "type": "string" },
                "transports": {
                  "type": "object",
                  "properties": {
                    "bus": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "metro": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "station": { "type": "string" }
                  }
                }
              }
            }
          },
          "required": ["infrastructure"]
        }
      ]
    }
  },
  "required": ["document_type", "metadata", "content"]
}
